# Addressing distributional and taxonomic uncertainty in the deep-sea giant isopod genus *Bathynomus* with an integrated observational and molecular framework

This repository provides versioned, executable examples supporting
the data-sourcing and curation workflows described in the manuscript.

### Sourcing the Global Biodiversity Information Facility
- `scripts/gbif_sourcing.R`  
  Reproducible retrieval and standardization of GBIF *Bathynomus* records.

- `data/gbif_output.csv`  
  Example output generated by the demo script.

### Sourcing NCBI mitochondrial barcodes

`scripts/ncbi_sourcing.R` demonstrates reproducible
retrieval of mitochondrial DNA barcode sequences for *Bathynomus* from
NCBI GenBank using the Entrez API.

The script retrieves a small, fixed number of records (n = 20),
extracts locus annotations and available metadata, and writes a
standardized CSV file to `data/`.

An NCBI API key is required and can be obtained free of charge from:
https://www.ncbi.nlm.nih.gov/account/settings/

### Global distribution mapping

`scripts/global_distribution.R` demonstrates integration of
morphological occurrence records and molecular barcode observations to
visualize the global distribution of the most common *Bathynomus* species (n observations > 50). Filters are applied to remove inland, aquarium, and uncertain records,
and outputs are written deterministically to `figures/`.

### Sparse-species global distributions

`scripts/global_distribution_sparse.R` visualizes global
distributions of rare Bathynomus species (â‰¤ 50 observations), separating
Atlantic and Indo-Pacific records and integrating morphological and
molecular observations with consistent symbology.

### Relative abundance estimation

`scripts/relative_abundance.R` demonstrates estimation of
relative abundance for *Bathynomus giganteus* using catch-per-unit-effort
(CPUE) standardized by trap-hours and modeled with a negative binomial GLM.

Inputs are provided as CSV files in `data/`, and all outputs (summary tables
and figures) are written deterministically to `data/` and `figures/`.

### Phylogenetic analysis

`scripts/COI_phylo.R` and `scripts/COX1_phylo.R` visualize phylogenetic relationships
of the cytochrome oxidase subunit I (COI) and the full length COX1 gene.

Gene accession inputs and .contree file are provided in `data/`, and the 
phylogenetic trees are written to `figures/`.

### Reproducibility
All scripts rely exclusively on public data and require no credentials.
The repository version archived in Dryad corresponds to the version cited
in the manuscript.
